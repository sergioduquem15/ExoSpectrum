::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  Python Radiative Transfer in a Bayesian framework (Pyrat Bay).
  Version 1.0.2.
  Copyright (c) 2021-2022 Patricio Cubillos.
  Pyrat Bay is open-source software under the GNU GPLv2 lincense (see LICENSE).
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

Read command-line arguments from configuration file:
'/work/SPECTRUM/spectrum_transmission.cfg'

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  Warning:
    Number of requested CPUs (2) is >= than the number of available CPUs (2).
Enforced ncpu to 1.
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

Check spectrum done.

Generating wavenumber array.

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  Warning:
    Final wavenumber modified from 33333.3333 cm-1 (input)
                                to 33333.0000 cm-1 (Pyrat).
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

  Initial wavenumber boundary:  2.00000e+03 cm-1  (5.000e+00 um)
  Final   wavenumber boundary:  3.33333e+04 cm-1  (3.000e-01 um)
  Wavenumber sampling interval: 1 cm-1
  Wavenumber sample size:         31334
  Wavenumber fine-sample size: 67679281
Wavenumber sampling done.

Reading atmospheric file: '/work/ATM/WASP-00b.atm'.
  Taking species constant parameters from:
'/root/venv/lib/python3.7/site-packages/pyratbay/data/molecules.dat'.
    Molecule   Radius  Mass
               (A)     (gr/mol)
          H2:  1.445    2.0159
          He:  1.400    4.0026
          Na:  2.270   22.9898
         H2O:  1.600   18.0153
         CH4:  2.000   16.0425
          CO:  1.690   28.0101
         CO2:  1.900   44.0095
         NH3:  1.800   17.0305
         HCN:  2.500   27.0253
          N2:  1.820   28.0134
  Species list:
    ['H2' 'He' 'Na' 'H2O' 'CH4' 'CO' 'CO2' 'NH3' 'HCN' 'N2']
  Abundances are given by volume mixing ratio.
  Unit factors: radius: None, pressure: bar, temperature: kelvin
  Number of layers in the input atmospheric file: 100
  Atmospheric file pressure limits: 1.00e-06--1.00e+02 bar.
  Median mean molecular mass: 2.367 g mol-1.
Read atmosphere done.

Reading line transition info.
  Read TLI file: '/work/RESULT/HITRAN_H2O_0.3-5.0um.tli'.
  TLI data storage: Little endian
  TLI version: 6.5.0.
  TLI wavenumber range (cm-1): [714.3, 10000.0]

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  Warning:
    TLI wavenumber range (714.29 - 10000.00 cm^-1) does not cover the full Pyrat
wavenumber range (2000.00 - 33333.33 cm^-1).
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

  Number of data bases: 1
  Data base name: 'HITRAN H2O'
  Molecule name: 'H2O'
  Temperature range:  1.0 -- 5000.0 K.
   Isotope: 161,  mass: 18.0106 u,  isotopic ratio: 0.9973
    Z = [1.00e+00, 1.01e+00, ..., 8.42e+04]
   Isotope: 181,  mass: 20.0148 u,  isotopic ratio: 0.001999
    Z = [1.00e+00, 1.01e+00, ..., 7.81e+04]
   Isotope: 171,  mass: 19.0148 u,  isotopic ratio: 0.0003719
    Z = [6.00e+00, 6.06e+00, ..., 4.69e+05]
   Isotope: 162,  mass: 19.0168 u,  isotopic ratio: 0.0003107
    Z = [6.00e+00, 6.21e+00, ..., 4.90e+05]
   Isotope: 182,  mass: 21.0211 u,  isotopic ratio: 6.23e-07
    Z = [6.00e+00, 6.22e+00, ..., 4.76e+05]
   Isotope: 172,  mass: 20.0211 u,  isotopic ratio: 1.158e-07
    Z = [3.60e+01, 3.73e+01, ..., 2.75e+06]
   Isotope: 262,  mass: 20.0210 u,  isotopic ratio: 2.42e-08
    Z = [6.00e+00, 6.34e+00, ..., 9.65e+05]
   Isotope: 282,  mass: 22.0000 u,  isotopic ratio: 0
    Z = [6.00e+00, 6.35e+00, ..., 9.93e+05]
   Isotope: 272,  mass: 21.0000 u,  isotopic ratio: 0
    Z = [3.60e+01, 3.81e+01, ..., 5.87e+06]
  Number of isotopes: 9
  DB index: 0, Cumulative Iso: 9

  Isotope's molecule indices:
    [3 3 3 3 3 3 3 3 3]
  There are 119,274 line transitions in TLI file.
  Found initial transition (    7943):      2000.3952 cm-1
  Found final   transition (   67167):      9999.9571 cm-1
    Read      59,225 transitions for isotope  0.
  Found initial transition (   70102):      2000.7835 cm-1
  Found final   transition (   92073):      9999.9392 cm-1
    Read      21,972 transitions for isotope  1.
  Found initial transition (   94380):      2000.7954 cm-1
  Found final   transition (  110216):      9999.3664 cm-1
    Read      15,837 transitions for isotope  2.
  Found initial transition (  112429):      2450.3977 cm-1
  Found final   transition (  118445):      9990.0871 cm-1
    Read       6,017 transitions for isotope  3.
  Found initial transition (  118882):      2586.9104 cm-1
  Found final   transition (  119100):      3824.7175 cm-1
    Read         219 transitions for isotope  4.
  Found initial transition (  119100):      3824.7175 cm-1
  Found final   transition (  119273):      1598.7655 cm-1
    Read         174 transitions for isotope  5.
  Read a total of 103,444 line transitions.
Line-transition done.

Generating atmospheric profile sample.
  Reference pressure: 1.000e-01 bar.
  Reference radius:      1.0 rjup.
  User pressure boundaries: 1.00e-06--1.00e+02 bar.
  Radius array (rjup) =   [1.011, 1.011, 1.011, 1.011, 1.011, 1.010, 1.010,
    1.010, 1.010, 1.010, 1.010, 1.009, 1.009, 1.009, 1.009, 1.009, 1.008, 1.008,
    1.008, 1.008, 1.008, 1.008, 1.007, 1.007, 1.007, 1.007, 1.007, 1.006, 1.006,
    1.006, 1.006, 1.006, 1.005, 1.005, 1.005, 1.005, 1.005, 1.005, 1.004, 1.004,
    1.004, 1.004, 1.004, 1.003, 1.003, 1.003, 1.003, 1.003, 1.003, 1.002, 1.002,
    1.002, 1.002, 1.002, 1.001, 1.001, 1.001, 1.001, 1.001, 1.001, 1.000, 1.000,
    1.000, 1.000, 1.000, 0.999, 0.999, 0.999, 0.999, 0.999, 0.999, 0.998, 0.998,
    0.998, 0.998, 0.998, 0.997, 0.997, 0.997, 0.997, 0.997, 0.997, 0.996, 0.996,
    0.996, 0.996, 0.996, 0.995, 0.995, 0.995, 0.995, 0.995, 0.995, 0.994, 0.994,
    0.994, 0.994, 0.994, 0.993, 0.993]
  Valid upper/lower radius boundaries:    1.01142 - 0.99327 rjup.
  Valid lower/higher pressure boundaries: 1.00e-06 - 1.00e+02 bar.
  Number of valid model layers: 100.
  Number of isotopes: 9
    Interpolating (isotope ID 0) partition function.
    Interpolating (isotope ID 1) partition function.
    Interpolating (isotope ID 2) partition function.
    Interpolating (isotope ID 3) partition function.
    Interpolating (isotope ID 4) partition function.
    Interpolating (isotope ID 5) partition function.
    Interpolating (isotope ID 6) partition function.
    Interpolating (isotope ID 7) partition function.
    Interpolating (isotope ID 8) partition function.
Make atmosphere done.

Calculate LBL Voigt profiles:
  Doppler width limits: 1.7e-03 -- 1.5e-01 cm-1 (40 samples).
  Lorentz width limits: 2.2e-08 -- 1.2e+01 cm-1 (40 samples).
  Voigt half-sizes:
  [[  364   409   459 ... 26397 29636 33273]
   [  364   409   459 ... 26397 29636 33273]
   [  364   409   459 ... 26397 29636 33273]
   ...
   [54000     0     0 ...     0     0     0]
   [54000     0     0 ...     0     0     0]
   [54000     0     0 ...     0     0     0]]
  Calculating Voigt profiles with max extent: 100.0 HWHM
  and fixed cutoff: 25.0 cm-1.
  Voigt indices:
  [[       0      729     1548 ...   424341   477136   536409]
   [  602956   603685   604504 ...  1027297  1080092  1139365]
   [ 1205912  1206641  1207460 ...  1630253  1683048  1742321]
   ...
   [26732927 26732927 26732927 ... 26732927 26732927 26732927]
   [26840928 26840928 26840928 ... 26840928 26840928 26840928]
   [26948929 26948929 26948929 ... 26948929 26948929 26948929]]
Voigt grid pre-calculation done.

Setup Alkali opacity models.

No extinction-coefficient table requested.

Reading cross-section files.
  Read CS file:
'/root/venv/lib/python3.7/site-packages/pyratbay/data/CIA/CIA_Borysow_H2H2_0060-7000K_0.6-500um.dat'.

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  Warning:
    The wavenumber range [20.000, 16480.000] cm-1 of the CS file:
    '/root/venv/lib/python3.7/site-packages/pyratbay/data/CIA/CIA_Borysow_H2H2_0060-7000K_0.6-500um.dat',
    does not cover the Pyrat's wavenumber range: [2000.000, 33333.000] cm-1.
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

    Cross-section opacity for H2-H2:
    Read 824 wavenumber and 20 temperature samples.
    Temperature sample limits: 60--7000 K
    Wavenumber sample limits: 20.0--16480.0 cm-1
  Read CS file:
'/root/venv/lib/python3.7/site-packages/pyratbay/data/CIA/CIA_Borysow_H2He_0050-3000K_0.3-030um.dat'.
    Cross-section opacity for H2-He:
    Read 1652 wavenumber and 20 temperature samples.
    Temperature sample limits: 50--3000 K
    Wavenumber sample limits: 320.0--33340.0 cm-1
Cross-section read done.

Begin CS interpolation.
Cross-section interpolate done.

Begin optical-depth calculation.
  Calculating extinction at layer   1/100 (T= 100.0 K, p=1.0e-06 bar).
  Calculating extinction at layer   2/100 (T= 100.0 K, p=1.2e-06 bar).
  Calculating extinction at layer   3/100 (T= 100.0 K, p=1.5e-06 bar).
  Calculating extinction at layer   4/100 (T= 100.0 K, p=1.7e-06 bar).
  Calculating extinction at layer   5/100 (T= 100.0 K, p=2.1e-06 bar).
  Calculating extinction at layer   6/100 (T= 100.0 K, p=2.5e-06 bar).
  Calculating extinction at layer   7/100 (T= 100.0 K, p=3.1e-06 bar).
  Calculating extinction at layer   8/100 (T= 100.0 K, p=3.7e-06 bar).
  Calculating extinction at layer   9/100 (T= 100.0 K, p=4.4e-06 bar).
  Calculating extinction at layer  10/100 (T= 100.0 K, p=5.3e-06 bar).
  Calculating extinction at layer  11/100 (T= 100.0 K, p=6.4e-06 bar).
  Calculating extinction at layer  12/100 (T= 100.0 K, p=7.7e-06 bar).
  Calculating extinction at layer  13/100 (T= 100.0 K, p=9.3e-06 bar).
  Calculating extinction at layer  14/100 (T= 100.0 K, p=1.1e-05 bar).
  Calculating extinction at layer  15/100 (T= 100.0 K, p=1.4e-05 bar).
  Calculating extinction at layer  16/100 (T= 100.0 K, p=1.6e-05 bar).
  Calculating extinction at layer  17/100 (T= 100.0 K, p=2.0e-05 bar).
  Calculating extinction at layer  18/100 (T= 100.0 K, p=2.4e-05 bar).
  Calculating extinction at layer  19/100 (T= 100.0 K, p=2.8e-05 bar).
  Calculating extinction at layer  20/100 (T= 100.0 K, p=3.4e-05 bar).
  Calculating extinction at layer  21/100 (T= 100.0 K, p=4.1e-05 bar).
  Calculating extinction at layer  22/100 (T= 100.0 K, p=5.0e-05 bar).
  Calculating extinction at layer  23/100 (T= 100.0 K, p=6.0e-05 bar).
  Calculating extinction at layer  24/100 (T= 100.0 K, p=7.2e-05 bar).
  Calculating extinction at layer  25/100 (T= 100.0 K, p=8.7e-05 bar).
  Calculating extinction at layer  26/100 (T= 100.0 K, p=1.0e-04 bar).
  Calculating extinction at layer  27/100 (T= 100.0 K, p=1.3e-04 bar).
  Calculating extinction at layer  28/100 (T= 100.0 K, p=1.5e-04 bar).
  Calculating extinction at layer  29/100 (T= 100.0 K, p=1.8e-04 bar).
  Calculating extinction at layer  30/100 (T= 100.0 K, p=2.2e-04 bar).
  Calculating extinction at layer  31/100 (T= 100.0 K, p=2.7e-04 bar).
  Calculating extinction at layer  32/100 (T= 100.0 K, p=3.2e-04 bar).
  Calculating extinction at layer  33/100 (T= 100.0 K, p=3.9e-04 bar).
  Calculating extinction at layer  34/100 (T= 100.0 K, p=4.6e-04 bar).
  Calculating extinction at layer  35/100 (T= 100.0 K, p=5.6e-04 bar).
  Calculating extinction at layer  36/100 (T= 100.0 K, p=6.7e-04 bar).
  Calculating extinction at layer  37/100 (T= 100.0 K, p=8.1e-04 bar).
  Calculating extinction at layer  38/100 (T= 100.0 K, p=9.8e-04 bar).
  Calculating extinction at layer  39/100 (T= 100.0 K, p=1.2e-03 bar).
  Calculating extinction at layer  40/100 (T= 100.0 K, p=1.4e-03 bar).
  Calculating extinction at layer  41/100 (T= 100.0 K, p=1.7e-03 bar).
  Calculating extinction at layer  42/100 (T= 100.0 K, p=2.1e-03 bar).
  Calculating extinction at layer  43/100 (T= 100.0 K, p=2.5e-03 bar).
  Calculating extinction at layer  44/100 (T= 100.0 K, p=3.0e-03 bar).
  Calculating extinction at layer  45/100 (T= 100.0 K, p=3.6e-03 bar).
  Calculating extinction at layer  46/100 (T= 100.0 K, p=4.3e-03 bar).
  Calculating extinction at layer  47/100 (T= 100.0 K, p=5.2e-03 bar).
  Calculating extinction at layer  48/100 (T= 100.0 K, p=6.3e-03 bar).
  Calculating extinction at layer  49/100 (T= 100.0 K, p=7.6e-03 bar).
  Calculating extinction at layer  50/100 (T= 100.0 K, p=9.1e-03 bar).
  Calculating extinction at layer  51/100 (T= 100.0 K, p=1.1e-02 bar).
  Calculating extinction at layer  52/100 (T= 100.0 K, p=1.3e-02 bar).
  Calculating extinction at layer  53/100 (T= 100.0 K, p=1.6e-02 bar).
  Calculating extinction at layer  54/100 (T= 100.0 K, p=1.9e-02 bar).
  Calculating extinction at layer  55/100 (T= 100.0 K, p=2.3e-02 bar).
  Calculating extinction at layer  56/100 (T= 100.0 K, p=2.8e-02 bar).
  Calculating extinction at layer  57/100 (T= 100.0 K, p=3.4e-02 bar).
  Calculating extinction at layer  58/100 (T= 100.0 K, p=4.0e-02 bar).
  Calculating extinction at layer  59/100 (T= 100.0 K, p=4.9e-02 bar).
  Calculating extinction at layer  60/100 (T= 100.0 K, p=5.9e-02 bar).
  Calculating extinction at layer  61/100 (T= 100.0 K, p=7.1e-02 bar).
  Calculating extinction at layer  62/100 (T= 100.0 K, p=8.5e-02 bar).
  Calculating extinction at layer  63/100 (T= 100.0 K, p=1.0e-01 bar).
  Calculating extinction at layer  64/100 (T= 100.0 K, p=1.2e-01 bar).
  Calculating extinction at layer  65/100 (T= 100.0 K, p=1.5e-01 bar).
  Calculating extinction at layer  66/100 (T= 100.0 K, p=1.8e-01 bar).
  Calculating extinction at layer  67/100 (T= 100.0 K, p=2.2e-01 bar).
  Calculating extinction at layer  68/100 (T= 100.0 K, p=2.6e-01 bar).
  Calculating extinction at layer  69/100 (T= 100.0 K, p=3.1e-01 bar).
  Calculating extinction at layer  70/100 (T= 100.0 K, p=3.8e-01 bar).
  Calculating extinction at layer  71/100 (T= 100.0 K, p=4.5e-01 bar).
  Calculating extinction at layer  72/100 (T= 100.0 K, p=5.5e-01 bar).
  Calculating extinction at layer  73/100 (T= 100.0 K, p=6.6e-01 bar).
  Calculating extinction at layer  74/100 (T= 100.0 K, p=7.9e-01 bar).
  Calculating extinction at layer  75/100 (T= 100.0 K, p=9.5e-01 bar).
  Calculating extinction at layer  76/100 (T= 100.0 K, p=1.1e+00 bar).
  Calculating extinction at layer  77/100 (T= 100.0 K, p=1.4e+00 bar).
  Calculating extinction at layer  78/100 (T= 100.0 K, p=1.7e+00 bar).
  Calculating extinction at layer  79/100 (T= 100.0 K, p=2.0e+00 bar).
  Calculating extinction at layer  80/100 (T= 100.0 K, p=2.4e+00 bar).
  Calculating extinction at layer  81/100 (T= 100.0 K, p=2.9e+00 bar).
  Calculating extinction at layer  82/100 (T= 100.0 K, p=3.5e+00 bar).
  Calculating extinction at layer  83/100 (T= 100.0 K, p=4.2e+00 bar).
  Calculating extinction at layer  84/100 (T= 100.0 K, p=5.1e+00 bar).
  Calculating extinction at layer  85/100 (T= 100.0 K, p=6.1e+00 bar).
  Calculating extinction at layer  86/100 (T= 100.0 K, p=7.4e+00 bar).
  Calculating extinction at layer  87/100 (T= 100.0 K, p=8.9e+00 bar).
  Calculating extinction at layer  88/100 (T= 100.0 K, p=1.1e+01 bar).
  Calculating extinction at layer  89/100 (T= 100.0 K, p=1.3e+01 bar).
  Calculating extinction at layer  90/100 (T= 100.0 K, p=1.6e+01 bar).
  Calculating extinction at layer  91/100 (T= 100.0 K, p=1.9e+01 bar).
  Calculating extinction at layer  92/100 (T= 100.0 K, p=2.3e+01 bar).
  Calculating extinction at layer  93/100 (T= 100.0 K, p=2.7e+01 bar).
  Calculating extinction at layer  94/100 (T= 100.0 K, p=3.3e+01 bar).
  Calculating extinction at layer  95/100 (T= 100.0 K, p=3.9e+01 bar).
  Calculating extinction at layer  96/100 (T= 100.0 K, p=4.8e+01 bar).
  Calculating extinction at layer  97/100 (T= 100.0 K, p=5.7e+01 bar).
  Calculating extinction at layer  98/100 (T= 100.0 K, p=6.9e+01 bar).
  Calculating extinction at layer  99/100 (T= 100.0 K, p=8.3e+01 bar).
  Calculating extinction at layer 100/100 (T= 100.0 K, p=1.0e+02 bar).
Optical depth done.

Calculate the planetary spectrum.
  Computed transmission spectrum: '/work/RESULT/transmission_spectrum.dat'.
Done.

Timestamps (s):
init      :   0.007264
wn sample :   1.607882
read atm  :   0.054269
read tli  :   0.201654
atm sample:   0.037157
voigt     :   1.376381
ext table :   0.003515
read cs   :   0.284262
interp cs :   0.095176
cloud+ray :   0.037416
alkali    :   0.428309
odepth    :  25.175153
spectrum  :   0.162945

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
  There were 4 warnings raised.  See
'/work/RESULT/warnings_transmission_spectrum.log'.
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
